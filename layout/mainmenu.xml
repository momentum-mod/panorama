<root>
	<styles>
		<include src="file://{resources}/styles/main.scss" />
	</styles>
	<scripts>
		<include src="file://{resources}/scripts/common/gameui.js" />
		<include src="file://{resources}/scripts/common/safeguards.js" />
		<include src="file://{resources}/scripts/mainmenu.js" />
		<include src="file://{resources}/scripts/mainmenu_drawer.js" />
	</scripts>

	<snippets>
		<snippet name="MainMenuMovieSnippet">
			<Panel>
				<!-- Source is set in script. -->
				<!-- Set what you want the movie to be using the data-type example 'nuke' the .webm is appended in script. -->
				<Movie
					class="mainmenu__movie MainMenuModeOnly"
					id="MainMenuMovie"
					src=""
					sound=""
					controls="none"
					repeat="true"
					hittest="false"
				>
				</Movie>
			</Panel>
		</snippet>
		<snippet name="MainMenuVanitySnippet">
			<Panel>
			</Panel>
		</snippet>
	</snippets>

	<ChaosMainMenu
		class="InitialDisplay MainMenuRootPanel"
		hittest="false"
		useglobalcontext="true"
		onload="MainMenuController.onMainMenuLoaded()"
	>

		<!-- Vanity is not used but the engine needs this to exist -->
		<Panel id="MainMenuVanityParent" />

		<Panel id="MainMenuInput" class="mainmenu">
			<!-- Topnav -->
			<Panel id="JsMainMenuNavBar" class="topnav" style="z-index: 10;">

				<RadioButton
					id="HomeButton"
					group="TopNavRadio"
					class="topnav__home"
					onactivate="MainMenuController.onHomeButtonPressed()"
				>
					<Image class="topnav__logo" src="file://{images}/momentumLogo.svg" textureheight="64" />
				</RadioButton>

				<Panel id="MainMenuTopButtons" class="full-height flow-right">
					<RadioButton
						id="PlayButton"
						group="TopNavRadio"
						class="topnav__button"
						onactivate="MainMenuController.navigateToTab('MapSelection', 'mainmenu_mapselector', false)"
					>
						<Image class="topnav__icon" src="file://{images}/play-circle.svg" textureheight="64" />
					</RadioButton>

					<RadioButton
						id="InventoryButton"
						group="TopNavRadio"
						class="topnav__button"
						onactivate="MainMenuController.navigateToTab('Inventory', 'mainmenu_inventory')"
					>
						<Image class="topnav__icon" src="file://{images}/inventory.svg" textureheight="64" />
					</RadioButton>

					<RadioButton
						id="ShopButton"
						group="TopNavRadio"
						class="topnav__button"
						onactivate="MainMenuController.navigateToTab('Shop', 'mainmenu_shop')"
					>
						<Image class="topnav__icon" src="file://{images}/shop.svg" textureheight="64" />
					</RadioButton>

					<RadioButton
						id="LearnButton"
						group="TopNavRadio"
						class="topnav__button"
						onactivate="MainMenuController.navigateToTab('Learn', 'mainmenu_learn')"
					>
						<Image class="topnav__icon" src="file://{images}/learn.svg" textureheight="64" />
					</RadioButton>

					<RadioButton
						id="SettingsButton"
						group="TopNavRadio"
						class="topnav__button"
						onactivate="MainMenuController.navigateToTab('Settings', 'mainmenu_settings')"
					>
						<Image class="topnav__icon" src="file://{images}/settings.svg" textureheight="64" />
					</RadioButton>
				</Panel>

				<Panel class="full-height flow-right horizontal-align-right">
					<RadioButton id="NotificationsButton" class="topnav__button">
						<Image class="topnav__icon" src="file://{images}/notification.svg" textureheight="64" />
					</RadioButton>

					<PlayerCard class="full-height" onactivate="Drawer.onPlayerCardPressed();" />

					<RadioButton id="QuitButton" class="topnav__button" onactivate="MainMenuController.onQuitButtonPressed()">
						<Image class="topnav__icon" src="file://{images}/quit.svg" textureheight="64" />
					</RadioButton>
				</Panel>

			</Panel>
			<!-- /Topnav -->

			<!-- Topnav Shadow -->
			<Panel class="topnav__shadow" />
			<!-- /Topnav Shadow -->

			<!-- Drawer -->
			<Panel id="MainMenuDrawerPanel" class="drawer">

				<!-- Rightnav Shadow -->
				<Panel class="rightnav__shadow" />
				<!-- /Rightnav Shadow -->

				<!-- Rightnav -->
				<Panel id="MainMenuOptionListRight" class="rightnav">
					<Panel class="rightnav__wrapper">
						<RadioButton
							id="LobbyButton"
							group="RightNavRadio"
							class="rightnav__button"
							onactivate="Drawer.extendAndNavigateToTab('LobbyDrawer')"
						>
							<Image id="LobbyButtonImage" class="rightnav__icon" src="file://{images}/lobby.svg" textureheight="32" />
							<Label id="LobbyPlayerCountLabel" class="rightnav__button-subtitle rightnav__button-subtitle--hidden" />
						</RadioButton>

						<RadioButton
							id="ProfileButton"
							group="RightNavRadio"
							class="rightnav__button"
							onactivate="Drawer.extendAndNavigateToTab('ProfileDrawer')"
						>
							<Image class="rightnav__icon" src="file://{images}/profile.svg" textureheight="32" />
						</RadioButton>

						<RadioButton
							id="ChallengesButton"
							group="RightNavRadio"
							class="rightnav__button"
							onactivate="Drawer.extendAndNavigateToTab('ChallengesDrawer')"
						>
							<Image class="rightnav__icon" src="file://{images}/crown.svg" textureheight="32" />
						</RadioButton>

						<RadioButton
							id="ChangelogButton"
							group="RightNavRadio"
							class="rightnav__button"
							onactivate="Drawer.extendAndNavigateToTab('AboutDrawer')"
						>
							<Image class="rightnav__icon" src="file://{images}/news.svg" textureheight="32" />
						</RadioButton>

						<Button
							id="SliderButton"
							group="RightNavRadio"
							class="rightnav__button rightnav__drawerbutton"
							onactivate="Drawer.toggle()"
						>
							<Image class="rightnav__icon" src="file://{images}/right-arrow.svg" textureheight="32" orientation="180" />
						</Button>
					</Panel>
				</Panel>
				<!-- /Rightnav -->

				<!-- Drawer Content -->
				<Panel id="MainMenuDrawerContent" class="drawer__content">
					<!-- Panels get added via JS here -->
				</Panel>
				<!-- /Drawer Content -->
			</Panel>
			<!-- /Drawer -->

			<!-- Full page blur: used to blur everything below the drawer -->
			<BaseBlurTarget
				id="MainMenuFullBlur"
				class="mainmenu__content-blur"
				blurrects="MainMenuDrawerContent MainMenuOptionListRight"
			>
				<Panel class="mainmenu__container">
					<!-- Backgrounds -->
					<!-- Background blur: used to blur the backgrounds behind mainmenu pages -->
					<BaseBlurTarget
						id="MainMenuBackgroundBlur"
						class="mainmenu__background-blur"
						blurrects="MainMenuContentBlur JsMainMenuNavBar NewsPanel"
					>
						<!-- Map Selector backgrounds -->
						<Image id="MainMenuBackgroundMapSelectorImage" class="MainMenuModeOnly mapselector__background" />

						<!-- Movie background -->
						<Panel id="MainMenuMovieParent" class="mainmenu__background MainMenuModeOnly" />

						<!-- Static image background -->
						<Image id="MainMenuBackground" class="mainmenu__background MainMenuModeOnly" />

						<!-- Backbuffer blur: used to blur the backbuffer in the pause menu -->
						<BaseBlurTarget id="PauseMenuMainMenuBlur" class="mainmenu__pause-blur" blurrects="PauseMenuMainMenuContent">
							<!-- Backbuffer background -->
							<ChaosBackbufferImagePanel class="mainmenu__background PauseMenuModeOnly" />
						</BaseBlurTarget>

					</BaseBlurTarget>
					<!-- /Backgrounds -->

					<Panel id="MainMenuContent" class="mainmenu__content">

						<Panel id="PauseMenuMainMenuContent" class="mainmenu__pause-content-blur" />

						<Panel id="HomeContent" class="mainmenu__home-container home MainMenuModeOnly">

							<Frame id="NewsPanel" class="home__newspanel" src="file://{resources}/layout/mainmenu_news.xml" />

							<ModelPanel
								id="MainMenuModel"
								class="home__modelpanel"
								src="models/custom_props/hd_logo.mdl"
								cubemap="cubemaps/cubemap_menu_model_bg.hdr"
								antialias="true"
								mouse_rotate="true"
							/>

							<Panel class="home__bottombar bottombar">

								<TooltipPanel class="bottombar__tooltip" tooltip="Main Site">
									<Button class="bottombar__button" onactivate="SteamOverlayAPI.OpenURLModal('https://momentum-mod.org/')">
										<Image class="bottombar__icon" src="file://{images}/social/home.svg" textureheight="64" />
									</Button>
								</TooltipPanel>

								<TooltipPanel class="bottombar__tooltip" tooltip="GitHub">
									<Button class="bottombar__button" onactivate="SteamOverlayAPI.OpenURLModal('https://github.com/momentum-mod/game')">
										<Image class="bottombar__icon" src="file://{images}/social/github.svg" textureheight="64" />
									</Button>
								</TooltipPanel>

								<TooltipPanel class="bottombar__tooltip" tooltip="Discord">
									<Button class="bottombar__button" onactivate="SteamOverlayAPI.OpenURLModal('https://discord.gg/momentummod')">
										<Image class="bottombar__icon" src="file://{images}/social/discord.svg" textureheight="64" />
									</Button>
								</TooltipPanel>

								<TooltipPanel class="bottombar__tooltip" tooltip="Forums">
									<Button class="bottombar__button" onactivate="SteamOverlayAPI.OpenURLModal('https://forum.momentum-mod.org/')">
										<Image class="bottombar__icon" src="file://{images}/social/forum.svg" textureheight="64" />
									</Button>
								</TooltipPanel>

								<TooltipPanel class="bottombar__tooltip" tooltip="Twitter">
									<Button class="bottombar__button" onactivate="SteamOverlayAPI.OpenURLModal('https://twitter.com/MomentumMod')">
										<Image class="bottombar__icon" src="file://{images}/social/twitter.svg" textureheight="64" />
									</Button>
								</TooltipPanel>

								<Button
									id="ControlsLibraryButton"
									class="bottombar__button hide"
									onactivate="MainMenuController.navigateToTab('ControlsLibrary', 'controlslibrary')"
								>
									<Label class="bottombar__text" text="Controls Library" />
								</Button>

								<Button id="PSDumpButton" class="bottombar__button hide" onactivate="MainMenuController.psdump()">
									<Label class="bottombar__text" text="dump ps" />
								</Button>

								<TooltipPanel class="bottombar__tooltip horizontal-align-right" tooltip="Switch background mode">
									<Button class="bottombar__button" onactivate="MainMenuController.toggleBackgroundLightDark()">
										<Image class="bottombar__icon" src="file://{images}/theme-light-dark.svg" textureheight="64" />
									</Button>
								</TooltipPanel>

							</Panel>
						</Panel>

						<Panel id="JsMainMenuContent" class="mainmenu__page-container mainmenu__page-container--hidden">

							<Panel id="MainMenuContentBlur" class="mainmenu__page-blur" />
							<!-- A panel gets inserted here dynamically from js, depending on which tab we click -->

						</Panel>
					</Panel>
				</Panel>
			</BaseBlurTarget>
		</Panel>

		<!-- Make sure these are at the bottom to get the z-order right -->
		<ToastManager />
		<ChaosPopupManager id="PopupManager" onpopupsdismissed="" />
		<ContextMenuManager id="ContextMenuManager" />
		<ChaosTooltipManager id="TooltipManager" hittest="false" />

		<!-- Doesn't actually include the notifications, but we use its position to figure out where to show them -->
		<Panel id="SteamNotificationsPlaceholder" hittest="false" />
	</ChaosMainMenu>
</root>
